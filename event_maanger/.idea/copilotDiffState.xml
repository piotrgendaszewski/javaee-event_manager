<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/AUTHRESOURCE_TEST_GUIDE.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/AUTHRESOURCE_TEST_GUIDE.md" />
              <option name="updatedContent" value="# AuthResource Tests - Dokumentacja&#10;&#10;## Testy JUnit dla AuthResource&#10;&#10;W pliku `src/test/java/REST/AuthResourceTest.java` znajduje się kompleksowy zestaw testów dla endpointów autentykacji.&#10;&#10;### Struktura testów&#10;&#10;Testy używają **Jersey Test Framework** do testowania REST endpointów:&#10;- `POST /auth/register` - rejestracja nowego użytkownika&#10;- `POST /auth/login` - logowanie użytkownika&#10;&#10;### Testy warte uwagi&#10;&#10;#### Testy walidacji polów&#10;&#10;```java&#10;@Test&#10;@DisplayName(&quot;Should return 400 for missing login in registration&quot;)&#10;void testRegisterWithMissingLogin()&#10;```&#10;&#10;Weryfikuje, że endpoint zwraca `400 Bad Request` gdy brakuje wymaganego pola.&#10;&#10;#### Testy mapowania endpointów&#10;&#10;```java&#10;@Test&#10;@DisplayName(&quot;Should map POST /auth/register endpoint&quot;)&#10;void testRegisterEndpointExists()&#10;```&#10;&#10;Potwierdza, że endpointy są prawidłowo mapowane w Jersey.&#10;&#10;#### Testy bezpieczeństwa&#10;&#10;```java&#10;@Test&#10;@DisplayName(&quot;Should not expose internal exceptions in error messages&quot;)&#10;void testErrorMessageSafety()&#10;```&#10;&#10;Weryfikuje, że błędy wewnętrzne nie są eksponowane w odpowiedziach.&#10;&#10;#### Testy typu contentu&#10;&#10;```java&#10;@Test&#10;@DisplayName(&quot;Should respond with JSON content type&quot;)&#10;void testResponseContentType()&#10;```&#10;&#10;Potwierdza, że odpowiedzi są w formacie JSON.&#10;&#10;## Uruchamianie testów&#10;&#10;### Z Maven&#10;&#10;```bash&#10;mvn test -Dtest=AuthResourceTest&#10;```&#10;&#10;### Z IDE (IntelliJ IDEA)&#10;&#10;1. Prawy klik na `AuthResourceTest.java` → **Run 'AuthResourceTest'**&#10;2. Lub: Ctrl+Shift+F10 (Windows)&#10;&#10;### Uruchomienie pojedynczego testu&#10;&#10;```bash&#10;mvn test -Dtest=AuthResourceTest#testRegisterWithMissingLogin&#10;```&#10;&#10;## Test HTML - Alternatywa&#10;&#10;Dla testowania bez JUnit, użyj interaktywnego testu HTML:&#10;&#10;```&#10;http://localhost:8080/event_maanger/auth-test.html&#10;```&#10;&#10;Zawiera:&#10;- ✅ Formularz rejestracji z walidacją&#10;- ✅ Formularz logowania z tokenami JWT&#10;- ✅ Szybkie testy predefiniowane&#10;- ✅ Wizualizacja odpowiedzi API&#10;&#10;## Skrypty CURL&#10;&#10;Jeśli preferujesz testowanie z linii poleceń:&#10;&#10;### Rejestracja&#10;&#10;```bash&#10;curl -X POST http://localhost:8080/event_maanger/api/auth/register \&#10;  -H &quot;Content-Type: application/json&quot; \&#10;  -d '{&#10;    &quot;login&quot;:&quot;testuser&quot;,&#10;    &quot;email&quot;:&quot;test@example.com&quot;,&#10;    &quot;password&quot;:&quot;password123&quot;,&#10;    &quot;firstName&quot;:&quot;Test&quot;,&#10;    &quot;lastName&quot;:&quot;User&quot;&#10;  }'&#10;```&#10;&#10;### Logowanie&#10;&#10;```bash&#10;curl -X POST http://localhost:8080/event_maanger/api/auth/login \&#10;  -H &quot;Content-Type: application/json&quot; \&#10;  -d '{&#10;    &quot;login&quot;:&quot;testuser&quot;,&#10;    &quot;password&quot;:&quot;password123&quot;&#10;  }'&#10;```&#10;&#10;## Testy Bash/PowerShell&#10;&#10;Dla automatyzacji, użyj skryptów testowych:&#10;&#10;### Linux/Mac&#10;&#10;```bash&#10;./auth-test.sh&#10;```&#10;&#10;### Windows&#10;&#10;```powershell&#10;.\auth-test.bat&#10;```&#10;&#10;## Czego testują&#10;&#10;| Test | Cel |&#10;|------|-----|&#10;| `testRegisterWithMissingLogin` | Walidacja wymaganego pola login |&#10;| `testRegisterWithMissingEmail` | Walidacja wymaganego pola email |&#10;| `testRegisterWithMissingPassword` | Walidacja wymaganego pola password |&#10;| `testLoginWithMissingLogin` | Walidacja pola login w logowaniu |&#10;| `testLoginWithMissingPassword` | Walidacja pola password w logowaniu |&#10;| `testLoginWithEmptyRequest` | Obsługa pustego body żądania |&#10;| `testRegisterEndpointExists` | Mapa endpoint `/auth/register` |&#10;| `testLoginEndpointExists` | Mapa endpoint `/auth/login` |&#10;| `testResponseContentType` | Typ contentu JSON |&#10;| `testErrorMessageSafety` | Nie ekspozycja błędów SQL |&#10;&#10;## Oczekiwane Kody HTTP&#10;&#10;| Scenariusz | Kod | Przykład |&#10;|-----------|-----|---------|&#10;| Sukces rejestracji | 201 | Created |&#10;| Sukces logowania | 200 | OK |&#10;| Brakujące pole | 400 | Bad Request |&#10;| Nieprawidłowe hasło | 401 | Unauthorized |&#10;| Login już istnieje | 409 | Conflict |&#10;| Błąd serwera | 500 | Internal Server Error |&#10;&#10;## Notatki techniczne&#10;&#10;- Testy używają **Jersey Test Framework** z wbudowanym konektorem (`InMemoryConnector`)&#10;- Każdy test jest niezależny i mogą być uruchamiane w dowolnej kolejności&#10;- Testy weryfikują HTTP responses, nie logikę biznesową DAO/Service&#10;- Do pełnego testowania integracyjnego użyj test HTML lub skryptów CURL&#10;&#10;## Rozwiązywanie problemów&#10;&#10;### Problem: SQLITE_BUSY&#10;&#10;```&#10;[SQLITE_BUSY] The database file is locked (database is locked)&#10;```&#10;&#10;**Rozwiązanie:**&#10;1. Zamknij wszystkie procesy używające `event_manager.sqlite`&#10;2. Usuń pliki `sqlite-*.jar` z temp&#10;3. Przebuduj: `mvn clean test`&#10;&#10;### Problem: Test timeout&#10;&#10;Jeśli testy trwają zbyt długo, zwiększ timeout:&#10;&#10;```bash&#10;mvn test -Dtest=AuthResourceTest -DtestFailureIgnore=false -Dmaven.test.timeout=30000&#10;```&#10;&#10;### Problem: Brak uprawnień&#10;&#10;Upewnij się, że katalog `data/` ma uprawnienia do zapisu:&#10;&#10;```bash&#10;chmod 755 data/&#10;```&#10;&#10;## Następne kroki&#10;&#10;Aby ulepszyć testy:&#10;&#10;1. ✅ Mockować `AuthService` zamiast całego `UserHibernate` (wymaga refaktoringu)&#10;2. ✅ Dodać testy integracyjne z rzeczywistą bazą danych&#10;3. ✅ Dodać testy wydajności/load testing&#10;4. ✅ Dodać testy bezpieczeństwa (SQL injection, XSS itp.)&#10;&#10;---&#10;&#10;**Ostatnia aktualizacja:** Luty 2026&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>